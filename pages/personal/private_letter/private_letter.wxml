<topBar showTabSearch="{{false}}" showIcon="{{true}}" tabTitle="私信 | {{topName}}"></topBar>

<view class="letter-container" bindtouchmove="hiddenComment">

    <scroll-view scroll-y bindscrolltoupper="upper" bindscrolltolower="lower" scroll-top="{{scrollTop}}" bindscroll="scroll" wx:for="{{list}}" wx:key="id" class='letter-content'>
        <block wx:if="{{item.form_user.id == user_id}}">
            <view class="scroll-view-item">
                <view class='user-left'>
                    <view class='left-content-avatar'>
                        <image class="avatar-border" src="/image/v2/border.png"></image>
                        <image class="avatar-item" src='{{baseImageUrl + item.form_user.avatar}}'></image>
                    </view>
                    <view class='left-content'>
                        <view class='left-content-message'>
                            <view class="qipao"></view>
                            <view wx:if="{{item.content != null && item.content_type == 'text'}}" class='left-content-item'>
                                {{item.content}}
                            </view>
                            <view class='left-content-item' wx:if="{{item.content != null && item.content_type == 'image'}}">
                                <image mode='widthFix' bindtap='previewImage' id="{{baseImageUrl+item.attachments[0]}}" src="{{baseImageUrl+item.attachments[0]}}"></image>
                            </view>
                        </view>
                        <view class='left-time'>{{item.created_at}}</view>
                    </view>

                </view>

            </view>
        </block>

        <block wx:if="{{item.form_user.id != user_id}}">
            <view class="scroll-view-item">
                <view class='user-right'>
                    <view class='right-content' data-objid="{{item.id}}" bindlongpress="deleteContent">
                        <view class='right-content-message'>
                            <view class='right-content-item' wx:if="{{item.content != null && item.content_type == 'text'}}">
                                {{item.content}}
                            </view>
                            <view class='right-content-item' wx:if="{{item.content != null && item.content_type == 'image'}}">
                                <image mode='widthFix' bindtap='previewImage' id="{{baseImageUrl+item.attachments[0]}}" src="{{baseImageUrl+item.attachments[0]}}"></image>
                            </view>
                            <view class="qipao-right"></view>
                        </view>
                        <view class='right-time'>{{item.created_at}}</view>
                    </view>

                    <view class='right-content-avatar'>
                        <image class="avatar-border" src="/image/v2/border.png"></image>
                        <image class="avatar-item" src='{{baseImageUrl + item.form_user.avatar}}'></image>
                    </view>

                </view>

            </view>
        </block>


    </scroll-view>

    <view class='hei' id="hei"></view>

    <view class='comment-input-container'>
        <view class='add-image' bindtap='sendImage'>
            <view class='image-container'>
                <van-uploader>
                    <image src="/image/get-phone-2.png" style="width: 45px;height: 45px; margin-top: 20rpx;"/>
                </van-uploader>
            </view>
        </view>
        <input class='text-content' maxlength="1024" bindinput='getContent' value='{{content}}'  placeholder="请输入内容" auto-height />
        <view class='send-button' bindtap='sendMessage'>
            <view>发送</view>
        </view>
    </view>
</view>